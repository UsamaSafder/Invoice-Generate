<div id="invoice-wrapper" style="display: flex; justify-content: center; padding: 20px;">
  <div style="width: 100%; max-width: 900px;">
    
    <!-- Fetch Invoice Form -->
    <div class="invoice-form">
      <h2>Fetch Invoice by Customer ID</h2>
      <div class="input-group">
        <input type="number" [(ngModel)]="CId" placeholder="Enter Customer ID" />
        <button (click)="fetchInvoiceData()">Fetch Invoice</button>
      </div>
    </div>

    <!-- Error Message -->
    <div *ngIf="errorMessage" class="error-msg">
      <p>{{ errorMessage }}</p>
    </div>

    <!-- Invoice Display -->
    <div *ngIf="customer && company && invoices.length > 0" id="invoice" class="invoice-box">
      
      <!-- Header with Company Name -->
      <div style="text-align: center; margin-bottom: 10px;">
       
        <p style="font-size: 50px; margin: 5px 0;">{{ company.CName }}</p>
      </div>

      <hr style="margin: 20px 0;" />

      <!-- Header Info -->
      <header class="top-section" style="display: flex; justify-content: space-between;">
        <div class="left">
          <h2 style="margin: 0;">INVOICE</h2>
          <p><strong>Customer ID:</strong> {{ customer.CId }}</p>
          <p><strong>Name:</strong> {{ customer.Name }}</p>
          <p><strong>Phone:</strong> {{ customer.PhoneNumber }}</p>
        </div>
        <div class="right company-info">
          <p>{{ company.Address }}</p>
          <p>{{ company.Email }}</p>
          <p>{{ company.PhoneNumber }}</p>
        </div>
      </header>

      <hr />

      <!-- Loop Through Invoices -->
      <div *ngFor="let inv of invoices" class="invoice-section">

        <div class="invoice-header" style="text-align: center;">
          <h3>Invoice #{{ inv.invoice.InvoiceID }}</h3>
          <p>Customer ID: {{ customer.CId }}</p>
        </div>

        <h4>Items</h4>
        <table class="item-table" style="width: 100%; border-collapse: collapse; margin-top: 10px;">
          <thead style="background: #000; color: #fff;">
            <tr>
              <th style="padding: 10px; border: 1px solid #ccc;">Description</th>
              <th style="padding: 10px; border: 1px solid #ccc;">Qty</th>
              <th style="padding: 10px; border: 1px solid #ccc;">Price</th>
              <th style="padding: 10px; border: 1px solid #ccc;">Total</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let item of inv.items">
              <td style="padding: 10px; border: 1px solid #ccc;">{{ item.Description }}</td>
              <td style="padding: 10px; border: 1px solid #ccc;">{{ item.Quantity }}</td>
              <td style="padding: 10px; border: 1px solid #ccc;">Rs. {{ item.Price }}</td>
              <td style="padding: 10px; border: 1px solid #ccc;">Rs. {{ item.Total }}</td>
            </tr>
          </tbody>
        </table>

        <!-- Totals -->
        <div class="totals-block" style="text-align: right; margin-top: 15px;">
          <p><strong>Subtotal:</strong> Rs. {{ inv.invoice.SubTotal }}</p>
          <p><strong>Tax (15%):</strong> Rs. {{ inv.invoice.Tax }}</p>
          <p><strong>Total:</strong> Rs. {{ inv.invoice.Total }}</p>
        </div>

        <!-- Payment Info -->
        <div class="payment-block" *ngIf="inv.payment" style="margin-top: 15px;">
          <h4>Payment</h4>
          <p><strong>Method:</strong> {{ inv.payment.method }}</p>
          <p><strong>Account Number:</strong> {{ inv.payment.account_number }}</p>
          <p><strong>Bank:</strong> {{ inv.payment.bank }}</p>
        </div>

        <hr />
      </div>
    </div>

    <!-- Action Buttons -->
    <div class="action-buttons" style="text-align: center; margin-top: 20px;">
      <button (click)="downloadPDF()" class="download-button">Download PDF</button>
     <a [routerLink]="['/']" class="generate-btn">Home Page</a>

    </div>

    <!-- No Data Found -->
    <div *ngIf="dataFetched && customer && invoices.length === 0" class="no-invoice-msg">
      <p>No invoices found for this customer.</p>
    </div>
    
  </div>
</div>
